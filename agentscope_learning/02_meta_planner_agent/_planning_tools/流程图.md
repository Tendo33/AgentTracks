åŸºäºå¯¹MetaPlannerçš„æ·±å…¥åˆ†æï¼Œæˆ‘ä¸ºä½ ç»˜åˆ¶ä¸€ä¸ªå®Œæ•´çš„æµç¨‹å›¾ï¼Œå¹¶ç”¨å…·ä½“ä¾‹å­è¯´æ˜å·¥ä½œæµç¨‹ï¼š

## ğŸ”„ MetaPlanner å®Œæ•´å·¥ä½œæµç¨‹å›¾

```mermaid
graph TB
    Start([ç”¨æˆ·è¾“å…¥å¤æ‚ä»»åŠ¡]) --> TaskType{ä»»åŠ¡ç±»å‹åˆ¤æ–­}
    TaskType -->|ç®€å•ä»»åŠ¡| SimpleMode[ç›´æ¥ReActå¤„ç†]
    TaskType -->|å¤æ‚ä»»åŠ¡| ComplexMode[è¿›å…¥MetaPlanneræ¨¡å¼]
    
    ComplexMode --> EnterMode[enter_solving_complicated_task_mode]
    EnterMode --> CreateDir[åˆ›å»ºä»»åŠ¡ç›®å½•]
    CreateDir --> PlanTool[æ¿€æ´»è§„åˆ’å·¥å…·ç»„]
    
    PlanTool --> Decompose[decompose_task_and_build_roadmap]
    Decompose --> SubTasks[ç”Ÿæˆå­ä»»åŠ¡åˆ—è¡¨]
    
    SubTasks --> TaskLoop{æ˜¯å¦è¿˜æœ‰æœªå®Œæˆå­ä»»åŠ¡}
    TaskLoop -->|æ˜¯| GetNext[get_next_unfinished_subtask_from_roadmap]
    TaskLoop -->|å¦| GenerateFinal[ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š]
    
    GetNext --> NeedWorker{éœ€è¦æ–°Worker?}
    NeedWorker -->|æ˜¯| CreateWorker[create_worker]
    NeedWorker -->|å¦| UseExist[ä½¿ç”¨ç°æœ‰Worker]
    
    CreateWorker --> AssignTools[åˆ†é…ä¸“é—¨å·¥å…·é›†]
    AssignTools --> RegisterPool[æ³¨å†Œåˆ°Workeræ± ]
    
    UseExist --> ExecuteWorker[execute_worker]
    RegisterPool --> ExecuteWorker
    
    ExecuteWorker --> WorkerTask[Workeræ‰§è¡Œå­ä»»åŠ¡]
    WorkerTask --> WorkerResponse[è¿”å›WorkerResponse]
    WorkerResponse --> UpdateRoadmap[revise_roadmap]
    UpdateRoadmap --> TaskLoop
    
    GenerateFinal --> End([ä»»åŠ¡å®Œæˆ])
    SimpleMode --> End
    
    style MetaPlanner fill:#e1f5fe
    style WorkerTask fill:#fff3e0
    style GenerateFinal fill:#e8f5e8
```

## ğŸ“Š æ ¸å¿ƒæ•°æ®æµ

```mermaid
graph LR
    UserInput[ç”¨æˆ·è¾“å…¥] --> Planner[PlannerNoteBook]
    Planner --> Roadmap[RoadMap]
    Roadmap --> SubTasks[SubTaskStatusæ•°ç»„]
    
    SubTasks --> Worker1[Worker Agent 1]
    SubTasks --> Worker2[Worker Agent 2]
    SubTasks --> Worker3[Worker Agent N]
    
    Worker1 --> Response1[WorkerResponse]
    Worker2 --> Response2[WorkerResponse]
    Worker3 --> Response3[WorkerResponse]
    
    Response1 --> Files[æ–‡ä»¶ç®¡ç†]
    Response2 --> Files
    Response3 --> Files
    
    Files --> FinalReport[æœ€ç»ˆèšåˆç»“æœ]
    
    style Planner fill:#f3e5f5
    style Files fill:#e3f2fd
```

## ğŸ¯ å®é™…ä¾‹å­ï¼šAIå‘å±•å†å²ç ”ç©¶æŠ¥å‘Š

è®©æˆ‘ç”¨ä¸€ä¸ªå…·ä½“ä¾‹å­æ¥è¯´æ˜æ•´ä¸ªè¿‡ç¨‹ï¼š

### ğŸ“ ä»»åŠ¡è¾“å…¥
```
ç”¨æˆ·ï¼šè¯·ç ”ç©¶å¹¶ç¼–å†™ä¸€ä»½å…³äºAIå‘å±•å†å²çš„ç»¼åˆæŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
1. é‡è¦æŠ€æœ¯çªç ´æ—¶é—´çº¿
2. å…³é”®äººç‰©åŠå…¶è´¡çŒ®
3. ä¸»è¦åº”ç”¨é¢†åŸŸå‘å±•
4. æœªæ¥è¶‹åŠ¿åˆ†æ
```

### ğŸ”„ æ‰§è¡Œæµç¨‹è¯¦è§£

#### **é˜¶æ®µ1ï¼šä»»åŠ¡åˆ†è§£**
MetaPlannerè°ƒç”¨ [`decompose_task_and_build_roadmap`](examples/agent/meta_planner_agent/_planning_tools/_roadmap_manager.py#L23-L67) å°†ä»»åŠ¡åˆ†è§£ä¸ºï¼š

```python
subtasks = [
    SubTaskSpecification(
        subtask_description="æ”¶é›†AIæŠ€æœ¯çªç ´å†å²æ•°æ®",
        exact_input="æœç´¢AIå‘å±•å²çš„é‡è¦é‡Œç¨‹ç¢‘äº‹ä»¶",
        expected_output="æŒ‰æ—¶é—´æ’åºçš„æŠ€æœ¯çªç ´æ¸…å•",
        desired_auxiliary_tools=["tavily_search", "read_file", "write_file"]
    ),
    SubTaskSpecification(
        subtask_description="æ•´ç†å…³é”®äººç‰©è´¡çŒ®",
        exact_input="åˆ†æAIé¢†åŸŸé‡è¦ç ”ç©¶äººå‘˜çš„è´¡çŒ®",
        expected_output="äººç‰©è´¡çŒ®æ¸…å•å’Œæ—¶é—´çº¿",
        desired_auxiliary_tools=["tavily_search", "write_file"]
    ),
    SubTaskSpecification(
        subtask_description="åˆ†æåº”ç”¨é¢†åŸŸå‘å±•",
        exact_input="ç ”ç©¶AIåœ¨å„é¢†åŸŸçš„åº”ç”¨å‘å±•å†ç¨‹",
        expected_output="åº”ç”¨é¢†åŸŸå‘å±•åˆ†ææŠ¥å‘Š",
        desired_auxiliary_tools=["tavily_search", "write_file"]
    ),
    SubTaskSpecification(
        subtask_description="æ’°å†™ç»¼åˆæŠ¥å‘Š",
        exact_input="æ•´åˆæ‰€æœ‰æ”¶é›†çš„ä¿¡æ¯",
        expected_output="å®Œæ•´çš„AIå‘å±•å†å²æŠ¥å‘Š",
        desired_auxiliary_tools=["read_file", "write_file", "edit_file"]
    )
]
```

#### **é˜¶æ®µ2ï¼šWorkeråˆ›å»ºä¸æ‰§è¡Œ**

**Worker 1 - å†å²ç ”ç©¶å‘˜**
```python
# è°ƒç”¨ create_worker
history_researcher = await worker_manager.create_worker(
    worker_name="history_researcher",
    worker_system_prompt="ä½ æ˜¯AIå†å²ç ”ç©¶ä¸“å®¶ï¼Œä¸“æ³¨äºæ”¶é›†å’Œæ•´ç†AIå‘å±•å²èµ„æ–™",
    tool_names=["tavily_search", "write_file"],
    agent_description="ä¸“é—¨è´Ÿè´£æ”¶é›†AIå†å²æ•°æ®"
)
```

**Worker 1 æ‰§è¡Œç»“æœï¼š**
```json
{
    "subtask_progress_summary": "æˆåŠŸæ”¶é›†äº†ä»1950å¹´åˆ°2024å¹´çš„AIé‡è¦çªç ´äº‹ä»¶ï¼ŒåŒ…æ‹¬è¾¾ç‰¹èŒ…æ–¯ä¼šè®®ã€æ·±åº¦å­¦ä¹ é©å‘½ç­‰å…³é”®èŠ‚ç‚¹",
    "generated_files": {
        "ai_timeline.md": "AIæŠ€æœ¯å‘å±•æ—¶é—´çº¿æ–‡æ¡£",
        "key_events.json": "å…³é”®äº‹ä»¶æ•°æ®æ–‡ä»¶"
    },
    "task_done": true
}
```

**Worker 2 - äººç‰©åˆ†æå‘˜**
```python
# ä¸ºäººç‰©åˆ†æä»»åŠ¡åˆ›å»ºä¸“é—¨çš„Worker
person_analyst = await worker_manager.create_worker(
    worker_name="person_analyst", 
    worker_system_prompt="ä½ æ˜¯AIé¢†åŸŸä¸“å®¶ï¼Œä¸“é—¨ç ”ç©¶AIé¢†åŸŸé‡è¦äººç‰©çš„è´¡çŒ®",
    tool_names=["tavily_search", "write_file"]
)
```

**Worker 2 æ‰§è¡Œç»“æœï¼š**
```json
{
    "subtask_progress_summary": "å®Œæˆäº†å¯¹å›¾çµã€éº¦å¡é”¡ã€è¾›é¡¿ç­‰20ä½AIé¢†åŸŸé‡è¦äººç‰©çš„è´¡çŒ®åˆ†æ",
    "generated_files": {
        "ai_pioneers.md": "AIå…ˆé©±äººç‰©è´¡çŒ®æŠ¥å‘Š",
        "researcher_timeline.json": "ç ”ç©¶äººå‘˜è´¡çŒ®æ—¶é—´çº¿"
    },
    "task_done": true
}
```

#### **é˜¶æ®µ3ï¼šç»“æœèšåˆæœºåˆ¶**

æ‰€æœ‰Workerçš„ç»“æœé€šè¿‡ [`execute_worker`](examples/agent/meta_planner_agent/_planning_tools/_worker_manager.py#L482-L549) æ–¹æ³•è‡ªåŠ¨èšåˆï¼š

```python
# ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œçš„èšåˆé€»è¾‘
self.planner_notebook.roadmap.decomposed_tasks[subtask_idx].workers.append(
    self.worker_pool[selected_worker_name][0]
)

# æ–‡ä»¶éªŒè¯å’Œç®¡ç†
for filepath, desc in worker_response.generated_files.items():
    if await check_file_existence(filepath, self.worker_full_toolkit):
        self.planner_notebook.files[filepath] = desc
```

**èšåˆåçš„PlannerNoteBookçŠ¶æ€ï¼š**
```json
{
    "roadmap": {
        "original_task": "ç ”ç©¶å¹¶ç¼–å†™AIå‘å±•å†å²æŠ¥å‘Š",
        "decomposed_tasks": [
            {
                "status": "Done",
                "workers": ["history_researcher"],
                "updates": [{"task_done": true, "subtask_progress_summary": "..."}]
            },
            {
                "status": "Done", 
                "workers": ["person_analyst"],
                "updates": [{"task_done": true, "subtask_progress_summary": "..."}]
            },
            {"status": "In-process", "workers": [], "updates": []},
            {"status": "Planned", "workers": [], "updates": []}
        ]
    },
    "files": {
        "ai_timeline.md": "AIæŠ€æœ¯å‘å±•æ—¶é—´çº¿æ–‡æ¡£",
        "key_events.json": "å…³é”®äº‹ä»¶æ•°æ®æ–‡ä»¶", 
        "ai_pioneers.md": "AIå…ˆé©±äººç‰©è´¡çŒ®æŠ¥å‘Š",
        "researcher_timeline.json": "ç ”ç©¶äººå‘˜è´¡çŒ®æ—¶é—´çº¿"
    }
}
```

#### **é˜¶æ®µ4ï¼šæœ€ç»ˆæŠ¥å‘Šç”Ÿæˆ**

**Worker 3 - æŠ¥å‘Šæ•´åˆå‘˜**
```python
# åˆ›å»ºæœ€ç»ˆçš„æŠ¥å‘Šæ•´åˆWorker
report_writer = await worker_manager.create_worker(
    worker_name="report_writer",
    worker_system_prompt="ä½ æ˜¯ä¸“ä¸šæŠ¥å‘Šå†™ä½œä¸“å®¶ï¼Œè´Ÿè´£æ•´åˆå¤šæ–¹ä¿¡æ¯ç”Ÿæˆé«˜è´¨é‡æŠ¥å‘Š",
    tool_names=["read_file", "write_file", "edit_file"]
)
```

**æœ€ç»ˆè¾“å‡ºï¼š**
- ç»Ÿä¸€çš„ `AI_Development_History_Report.md`
- åŒ…å«æ‰€æœ‰å­ä»»åŠ¡æˆæœçš„å®Œæ•´æŠ¥å‘Š
- æ‰€æœ‰æºæ–‡ä»¶çš„å¼•ç”¨å’Œæ•´åˆ

## ğŸ”‘ å…³é”®è®¾è®¡ä¼˜åŠ¿

1. **æ¨¡å—åŒ–åˆ†å·¥**ï¼šæ¯ä¸ªWorkerä¸“æ³¨ç‰¹å®šé¢†åŸŸï¼Œæé«˜ä¸“ä¸šæ€§
2. **åŠ¨æ€èµ„æºåˆ†é…**ï¼šæŒ‰éœ€åˆ›å»ºWorkerï¼Œé¿å…èµ„æºæµªè´¹  
3. **ç»Ÿä¸€çŠ¶æ€ç®¡ç†**ï¼šé€šè¿‡PlannerNoteBooké›†ä¸­ç®¡ç†æ‰€æœ‰çŠ¶æ€å’Œç»“æœ
4. **é”™è¯¯æ¢å¤**ï¼šæ”¯æŒä»»åŠ¡çŠ¶æ€ä¿å­˜å’Œæ¢å¤ï¼Œå¯ä¸­æ–­ç»§ç»­æ‰§è¡Œ
5. **å·¥å…·ä¼˜åŒ–**ï¼šæ¯ä¸ªWorkeråªè·å¾—å®Œæˆä»»åŠ¡å¿…éœ€çš„å·¥å…·ï¼Œæé«˜æ•ˆç‡

è¿™ç§è®¾è®¡ä½¿å¾—å¤æ‚ä»»åŠ¡èƒ½å¤Ÿè¢«ç³»ç»Ÿæ€§åœ°åˆ†è§£ã€æ‰§è¡Œå’Œæ•´åˆï¼Œæœ€ç»ˆäº§ç”Ÿé«˜è´¨é‡çš„ç»¼åˆç»“æœã€‚

æƒ³äº†è§£æ›´å¤šå…³äºReAct Agentå’Œå¤šAgentåä½œçš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒ [ReAct Agent å®ç°](11-react-agent-implementation) å’Œ [å¤š Agent å¯¹è¯æ¨¡å¼](13-multi-agent-conversation-patterns)ã€‚